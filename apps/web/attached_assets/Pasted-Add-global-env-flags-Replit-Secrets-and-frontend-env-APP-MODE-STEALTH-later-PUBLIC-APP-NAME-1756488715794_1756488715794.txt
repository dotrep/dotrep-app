Add global env flags (Replit Secrets and frontend .env)

APP_MODE = STEALTH (later PUBLIC)

APP_NAME = App (later FSN)

TLD_LABEL = .id (later .fsn)

CHAIN_NAME = Devnet (later Base / Base Sepolia)

LOCAL_RPC_URL = http://127.0.0.1:8545

BASE_SEPOLIA_RPC_URL = your Alchemy/Infura URL (leave unset until PUBLIC)

ENABLE_ANALYTICS = false (later true)

ENABLE_SHARE_LINKS = false (later true)

Centralize runtime config (frontend)

Create a small config module that reads NEXT_PUBLIC_* or plain env vars and exposes:
appMode, appName, tldLabel, chainName, rpcUrl, feature flags.

rpcUrl selects LOCAL_RPC_URL when STEALTH, Base RPC when PUBLIC.

Replace all hardcoded strings with config

Search the entire frontend for “FSN”, “.fsn”, “passport”, “Base”.

Replace with variables: appName, tldLabel, chainName, or neutral terms (“ID”, “profile”).

Keep .fsn out of copy until PUBLIC.

Wallet connector gating

If appMode = STEALTH: show MetaMask + WalletConnect only; hide Coinbase Wallet and any explorer links.

If appMode = PUBLIC: enable Coinbase Wallet; show Basescan links where appropriate.

Explorer and chain links

Wrap all “view on explorer” buttons in a feature flag: show only when PUBLIC.

For local development, show a tiny dev badge with chainName = Devnet and contract addresses (from deployments/local.json).

Analytics/telemetry switches

Behind ENABLE_ANALYTICS: init any analytics SDKs (disable when STEALTH).

Strip any console banners or metadata that mention the brand when STEALTH.

Disable third-party pixels until PUBLIC.

Branding assets

In STEALTH: generic monochrome favicon/logo and generic OG meta (“On-chain ID demo”).

In PUBLIC: swap to brand assets (logo, colors, meta), controlled by env flags so no code diff is needed.

Feature flags by mode

ENABLE_SHARE_LINKS (referral links, social share buttons): false in STEALTH, true in PUBLIC.

ENABLE_EVENT_BADGES (show “Verified on-chain”/explorer): false in STEALTH, true in PUBLIC.

ENABLE_PUBLIC_GATEWAY (render IPFS gateway links): false in STEALTH, true in PUBLIC.

Server-side safeguards

Add CORS allowlist for your own domains only, broader list only when PUBLIC.

Rate-limit sensitive routes (claim, upload) with conservative limits in STEALTH.

Hide any “/health” or “/status” routes behind basic auth or a secret token.

Ensure logs do not include user files, CIDs, or wallet addresses when STEALTH (or redact).

Flip procedure (one-minute checklist)

Set APP_MODE = PUBLIC.

Set APP_NAME = FSN, TLD_LABEL = .fsn, CHAIN_NAME = Base (or Base Sepolia first).

Set BASE_SEPOLIA_RPC_URL (or BASE_MAINNET_RPC_URL later).

Add/enable Coinbase Wallet connector.

Set ENABLE_ANALYTICS = true, ENABLE_SHARE_LINKS = true, ENABLE_PUBLIC_GATEWAY = true, ENABLE_EVENT_BADGES = true.

Point frontend to /contracts/deployments/base-sepolia.json (or base.json).

Restart the app; verify wallet modal shows all connectors, explorer links appear, leaderboard/XP reads are stable.

Visual guardrail (so you never forget the mode)

Add a small top-right pill that shows the current mode:
“STEALTH MODE • Devnet” (gray) vs “PUBLIC • Base Sepolia” (blue) vs “PUBLIC • Base” (green).

Only visible to logged-in admin/dev users if you prefer, but on by default during build.

QA for the flip

In STEALTH: no brand strings, no explorer links, local RPC active, share links hidden, analytics off.

After flipping to PUBLIC: brand appears, explorer links work, Coinbase Wallet connects, referrals enabled, cron writes XP on-chain.

Post-flip rollback plan

Keep a “panic” env set ready (APP_MODE back to STEALTH, or a MAINTENANCE flag).

If something breaks on Base Sepolia, flip back to STEALTH, continue testing locally, redeploy contracts if needed, then try PUBLIC again.

Documentation

Create a short “ReadMe – Modes” section explaining: which envs to set, where deployments JSON lives, which features toggle per mode, and the one-minute flip steps above.